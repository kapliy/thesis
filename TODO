This is v1 of the thesis.
